<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head >
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>树洞-首页</title>

    <link href="../static/myImages/树洞.jpg"  rel="icon" type="image/x-ico">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/semantic-ui/2.2.4/semantic.min.css">
    <link rel="stylesheet" href="../../static/lib/editormd/css/editormd.min.css" >
	<link rel="stylesheet" href="../static/css/TGTool.css">
    <link rel="stylesheet" href="../static/css/me.css" >
</head>
<body>

<!--导航-->
<nav id="nav" class="gird-header" style="display: none" >
    
</nav>




<!--顶部图片-->
<div class="m-bg-class_outer" style="width: 100%;height: 750px">
    <img src="../static/myImages/jingyu.jpg" alt="" class="ui m-bg image" style="width: 100%;height: 100%" id="bg">
    <div class="m-bg-class_cover" align="center">
        <div class="m-margin-top-maxx" align="center">
            <img class="ui circular image" align="center" src="" style="width: 150px;height: 150px;" id="userAvatar">
        </div>
        <div class="m-font-size-title-large" align="center" id="nickname"></div>

        <div class="" align="center">
            <a href="#" class="ui tencent circular icon button"><i class="user icon"></i></a>
            <a href="#" class="ui wechat circular icon button"><i class="weixin icon"></i></a>
            <a href="#" class="ui qq circular icon button" data-content="316392836" data-position="bottom center"><i class="qq icon"></i></a>
            <a href="https://github.com/chenGoZiHeTaDeTuiZi" target="_blank" class="ui github circular icon button" data-content="点击跳转GitHub" data-position="bottom center"><i class="github icon"></i></a>
            <a href="https://blog.csdn.net/m0_56662317?spm=1000.2115.3001.5343" target="_blank" class="ui csdn circular icon button" data-content="点击跳转CSDN" data-position="bottom center"><i class="copyright outline icon"></i></a>
            <a href="#" class="ui email circular icon button" data-content="1465675493@qq.com" data-position="bottom center"><i class="envelope  icon"></i></a>
        </div>

        <div class="ui tencent-qr flowing popup transition hidden">
            <img src="../static/myImages/bilibli.jpg"  alt="" class="ui rounded image" style="width: 110px">
            <div align="center">b站</div>
        </div>
        <div class="ui wechat-qr flowing popup transition hidden">
            <img src="../static/myImages/zbb-wv.jpg" alt="" class="ui rounded image" style="width: 110px">
            <div align="center">微信</div>
        </div>
        <div class="ui qq-qr flowing popup transition hidden">
            <img src="../static/myImages/zzb-qq.jpg" alt="" class="ui rounded image" style="width: 110px">
            <div align="center">QQ</div>
        </div>

        <h3 class="m-font-size-text" align="center">"一鲸落，万物生"</h3>
        <hr style="width: 30%">
        <h5 class="m-font-size-text-init-title m-margin-top-large">“生当似鹏起，终当如鲸落”</h5>
        <h5 class="m-font-size-text-init-title">“万物有灵且美，万物因爱而生”</h5>
        <h5 class="m-font-size-text-init-title">“此落便一去不回……”</h5>
        <h5 class="m-font-size-text-init-title">“这是鲸，给予大海最后的温柔”</h5>
        <div id="waypoint" class="ui m-margin-top-large" align="center">
            <a href="index.html" class="ui circular icon button m-opacity-small m-item item m-mobile-hide m-index-btn" ><i class="home icon"></i>首页</a>
            <a href="types.html" class="ui circular icon button m-opacity-small m-item item m-mobile-hide m-index-btn" ><i class="clone outline icon"></i>分类</a>
            <a href="archives.html" class="ui circular icon button m-opacity-small m-item item m-mobile-hide m-index-btn" ><i class="clock icon"></i>时间轴</a>
            <a href="music.html" class="ui circular icon button m-opacity-small m-item item m-mobile-hide m-index-btn" ><i class="music icon"></i>音乐盒</a>
            <a href="javascript:void(0)" onclick="chackIfUser(1)" class="ui circular icon button m-opacity-small m-item item m-mobile-hide m-index-btn" ><i class="book icon"></i>留言板</a>
            <a href="friends.html" class="ui circular icon button m-opacity-small m-item item m-mobile-hide m-index-btn" ><i class="pencil alternate icon"></i>友人帐</a>
            <a href="javascript:void(0)" onclick="chackIfUser(0)" class="ui circular icon button m-opacity-small m-item item m-mobile-hide m-index-btn" ><i class="icon user"></i>管理</a>
			<a href="picture.html" class="ui circular icon button m-opacity-small m-item item m-mobile-hide m-index-btn" ><i class="image icon"></i>照片墙</a>
            <a href="about.html" class="ui circular icon button m-opacity-small m-item item m-mobile-hide m-index-btn" ><i class="info icon"></i>栈主</a>
        </div>
        <div class="hiddenDiv"></div>
    </div>

</div>



<!--最新推荐-->
<div class="ui m-padded-tb-large" id="RecommendBlogsList">
    <script type="text/template" id="RecommendBlogsListT">
		<div class="ui m-container-small m-opacity">
			<div class="ui secondary segment " align="center">
				<i class="bookmark icon"></i>最新推荐
			</div>
		</div>
    	<div class="ui stackable m-container-mini m-opacity grid">
		{{#each this}}
    	    <div class="m-margin-tb-tiny four wide column">
    	        <a href="blog.html?id={{id}}" class="class_outer" target="_blank">
    	            <img src="{{firstPicture}}"  class="ui rounded image">
    	            <span class="class_cover" >
    	                 <h4 class="m-font-size-blog-text m-margin-tb-tiny">{{title}}</h4>
    	              </span>
    	        </a>
    	    </div>
		{{/each}}
    	</div>
    </script>
	
</div>


<!--中间内容-->
<div class="m-padded-tb-big animated fadeIn">
    <div class="ui container">
        <div class="ui stackable grid" id="firstPagesBlogsList">
			
        </div>
    </div>

</div>


<!--置顶图标-->
<div class="m-padded-tb-large m-fixed m-right-bottom">
    <a href="#" class="ui icon button"><i class="chevron up icon"></i> </a>
</div>
<!--首次弹出框-->
<div class="ui basic modal">
  <div class="ui icon header">
    <i class="archive icon"></i>
    <h1>小客栈公告</h1>
  </div>
  <div class="content">
    <h3>欢迎客官,这里是一些温馨公告</h3>
	<h3>1.有任何问题都可以在栈主或者管理员留言板下留言哦~</h3>
	<h3>2.游客登陆下没有发布博客，上传照片和留言板功能哦~</h3>
	<h3>3.网站仅供参考或学习等使用，不作其他用途</h3>
	<h3>4.若有需要可向栈主留言询问源码</h3>
	<h3>5.树洞安全性与输入，性能等欠佳，请客观手下留情哦</h3>
	<h3>6.喜欢树洞的图片与照片？可向栈主留言询问图片连接</h3>
	<h3>7.您有喜欢的图片想随时随地在线浏览，可向栈主留言储存至图床哦</h3>
	<h3>7.开始树洞之旅吧！</h3>
  </div>
  <div class="actions">
    <div class="ui green ok inverted button">
      <i class="checkmark icon"></i>
      好的
    </div>
  </div>
</div>


<br>
<br>
<br>
<!--底部栏-->
<footer class="ui inverted vertical segment m-padded-tb-massive m-opacity" id="home-end">
    
</footer>



<script src="https://cdn.jsdelivr.net/npm/jquery@3.2/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/semantic-ui/2.2.4/semantic.min.js"></script>
<script src="js/handlebars-v4.7.7.js" type="text/javascript"></script>
<script src="../static/lib/waypoints/jquery.waypoints.min.js"></script>
<script src="js/myJs.js"></script>
<script src="js/TGTool.js"></script>
<script src="https://eqcn.ajz.miesnfu.com/wp-content/plugins/wp-3d-pony/live2dw/lib/L2Dwidget.min.js"></script>

<script>
	     <!--小帅哥： https://unpkg.com/live2d-widget-model-chitose@1.0.5/assets/chitose.model.json-->
	      <!--萌娘：https://unpkg.com/live2d-widget-model-shizuku@1.0.5/assets/shizuku.model.json-->
	      <!--小可爱（女）：https://unpkg.com/live2d-widget-model-koharu@1.0.5/assets/koharu.model.json-->
	      <!--小可爱（男）：https://unpkg.com/live2d-widget-model-haruto@1.0.5/assets/haruto.model.json-->
	      <!--初音：https://unpkg.com/live2d-widget-model-miku@1.0.5/assets/miku.model.json-->
	    L2Dwidget.init({ "model": { jsonPath:
	          "https://unpkg.com/live2d-widget-model-koharu@1.0.5/assets/koharu.model.json",
	        "scale": 1 }, "display": { "position": "left", "width": 110, "height": 150,
	        "hOffset": 0, "vOffset": -20 }, "mobile": { "show": true, "scale": 0.5 },
	      "react": { "opacityDefault": 0.8, "opacityOnHover": 0.1 } });
	  </script>
<script>
	
	$(function(){
		chackLogin(0);
		$("#nav").load("home-top.html")
		$("#home-end").load("home-end.html")
	    var key=searchurl("key");
		if(key=="huangying")
			$('.ui.basic.modal').modal('show');
	  
	    var user= JSON.parse(localStorage.getItem('user'));
	    $("#userAvatar").attr('src',user.avatar);
	    $("#nickname").html(user.nickname);
		$.ajax({
			type: "GET",
			dataType: "json",
			url: "http://81.71.4.36:18080/indexBlogs",
			beforeSend: function(request) {
				request.setRequestHeader("token",window.localStorage.getItem("token"));
			},
			success: function(data) {
				var tpl = $("#firstPagesBlogsListT").html()
				var template = Handlebars.compile(tpl)
				var html = template(data[0])
				$("#firstPagesBlogsList").html(html)
					
					var tpl = $("#RecommendBlogsListT").html()
					var template = Handlebars.compile(tpl)
					var html = template(data[1])
					$("#RecommendBlogsList").html(html)
			},
				error:function(data){
					location.href="error/500.html";
				}
		});
	  $.ajax({
	  	type: "GET",
	  	dataType: "json",
	  	url: "http://81.71.4.36:18080/pictures/indexBg",
	  	beforeSend: function(request) {
	  		request.setRequestHeader("token",window.localStorage.getItem("token"));
	  	},
	  	success: function(data) {
			$("#bg").attr('src',data.indexBg);
	  	},
	  	error:function(data){
	  		location.href="error/500.html";
	  	}
	  });
	});
	function searchurl(str) {
		var LocString = String(window.document.location.href);
		var rs = new RegExp("(^|)" + str + "=([^&]*)(&|$)", "gi").exec(LocString),
			tmp;
		if (tmp = rs) return tmp[2];
		return null;
	}
	function chackIfUser(i){
		var user = JSON.parse(window.localStorage.getItem("user"));
		if(user.type==2){
			if(i==0)
				alert("登陆后就能发表自己的博客和分享自己的照片啦！");
			else
				alert("登陆后就能查看自己的留言版啦！");
		}
		else{
			if(i==0)
				location.href="user-blog.html";
			else
				location.href="message.html"
		}
	}
    // 显示公众号
    $('.tencent').popup({
        popup : $('.tencent-qr'),
        position: 'bottom center'
    });

    // 显示微信
    $('.wechat').popup({
        popup : $('.wechat-qr'),
        position: 'bottom center'
    });

    // 显示QQ
    $('.qq').popup({
        popup : $('.qq-qr'),
        position: 'bottom center'
    });

    // 显示邮箱
    $('.email').popup();

    // 显示CSDN
    $('.csdn').popup();

    // 显示github
    $('.github').popup();

    // 导航栏显示
    var waypoint = new Waypoint({
        element: document.getElementById('waypoint'),
        handler: function(direction) {
            if (direction == 'down') {
                $('#nav').show(500);
            } else {
                $('#nav').hide(500);
            }
            console.log('Scrolled to waypoint!  ' + direction);
        }
    })
</script>
</body>
<script type="text/template" id="firstPagesBlogsListT">
            <!--博客内容-->
            <div class="ui vertical segment" >
					<div class="ui m-container-small m-opacity">
						<div class="ui secondary segment " align="center">
							<i class="bookmark icon"></i>最新文章
						</div>
					</div>
                <!--博文列表-->
				{{#each records}}
                <div class="ui padded segment m-padded-tb-large m-opacity" >			
                    <div class="ui large aligned mobile reversed stackable grid" >
                        <!--博文信息-->                                              
                        	<div class="eleven wide column ">
                        	    <h3 class="ui header" ><a href="blog.html?id={{id}}" target="_blank" class="m-black">{{title}}</a></h3>
                        	    <p class="m-text m-margin-top-max">{{description}}</p>
                        	    <div class="ui m-margin-top-max grid">
                        	        <div class="eleven wide column">
                        	            <div class="ui mini horizontal link list">
                        	                <div class="item">
                        	                    <img src="{{avatar}}"  alt="" class="ui avatar image">
                        	                    <div class="content"><a href="message.html" target="_blank" class="header" >{{nickname}}</a></div>
                        	                </div>
                        	                <div class="item">
                        	                    <i class="calendar icon"></i><span>{{updateTime}}</span>
                        	                </div>
                        	                <div class="item">
                        	                    <i class="eye icon"></i> <span>{{views}}</span>
                        	                </div>
                        	                <div class="item">
                        	                    <i class="comment outline icon"></i> <span>{{commentCount}}</span>
                        	                </div>
                        	            </div>
                        	        </div>
                        	        <div class="right aligned five wide column">
                        	            <p class="ui teal basic label m-padded-tiny m-text-thin">{{typeName}}</p>
                        	        </div>
                        	    </div>
                        	</div>
							
                        	<!--博文图片-->
                        	<div class="five wide column">
                        	    <a href="blog.html?id={{id}}" target="_blank">
                        	        <img src="{{firstPicture}}" alt="" class="ui rounded image">
                        	    </a>
                        	</div>

					
                    </div>
					
                </div>
				{{/each}}
				
            </div>
            <!--分页-->
            <div class="ui bottom attached segment m-opacity stackable grid">
                <div class="three wide column" align="center" >
                    <a class="item" href="javascript:void(0)" onclick="pagesHeper({{pageNum}},{{pages}},0,'Is')">上一页</a>
                </div>

                <div class="ten wide column" align="center">
                    <p> <span></span> {{pageNum}}/{{pages}} <span></span> </p>
                </div>

                <div class="three wide column" align="center">
                    <a class="item" href="javascript:void(0)" onclick="pagesHeper({{pageNum}},{{pages}},1,'Is')">下一页</a>
                </div>
            </div>
			</script>
</html>